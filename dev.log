
> paysolutions-loans@0.1.0 dev
> next dev --turbopack

   ‚ñ≤ Next.js 15.3.4 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://192.168.1.151:3000
   - Environments: .env.local

 ‚úì Starting...
 ‚ö† Invalid next.config.ts options detected: 
 ‚ö†     Unrecognized key(s) in object: 'serverComponentsExternalPackages' at "experimental"
 ‚ö† See more info here: https://nextjs.org/docs/messages/invalid-next-config
 ‚ö† `experimental.serverComponentsExternalPackages` has been moved to `serverExternalPackages`. Please update your next.config.ts file accordingly.
 ‚úì Compiled middleware in 101ms
 ‚úì Ready in 699ms
 ‚ö† Webpack is configured while Turbopack is not, which may cause problems.
 ‚ö† See instructions if you need to configure Turbopack:
  https://nextjs.org/docs/app/api-reference/next-config-js/turbo

 ‚óã Compiling /admin/borrowers ...
 ‚úì Compiled /admin/borrowers in 876ms
 GET /admin/borrowers 200 in 1019ms
 ‚úì Compiled /api/borrowers/[id] in 265ms
 DELETE /api/borrowers/8dba0b65-ec10-4c69-81ed-0382f0a14eb7 200 in 617ms
 ‚úì Compiled in 55ms
 ‚úì Compiled in 51ms
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
 ‚úì Compiled in 36ms
 GET /admin/borrowers 200 in 136ms
 ‚úì Compiled /favicon.ico in 152ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 386ms
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
 ‚úì Compiled in 39ms
 GET /admin/borrowers 200 in 91ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 220ms
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
 ‚úì Compiled in 58ms
 GET /admin/borrowers 200 in 93ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 220ms
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
 ‚úì Compiled in 42ms
 GET /admin/borrowers 200 in 97ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 220ms
 ‚úì Compiled /admin/loans/create in 338ms
 GET /admin/loans/create 200 in 360ms
 ‚úì Compiled in 26ms
 ‚úì Compiled in 32ms
 ‚úì Compiled /api/borrowers in 184ms
Error creating borrower: {
  code: 'PGRST204',
  details: null,
  hint: null,
  message: "Could not find the 'country' column of 'borrowers' in the schema cache"
}
 POST /api/borrowers 500 in 360ms
Error creating borrower: {
  code: 'PGRST204',
  details: null,
  hint: null,
  message: "Could not find the 'country' column of 'borrowers' in the schema cache"
}
 POST /api/borrowers 500 in 199ms
 ‚úì Compiled in 49ms
 POST /api/borrowers 201 in 263ms
 ‚úì Compiled /api/loans in 190ms
Error creating loan: {
  code: 'PGRST204',
  details: null,
  hint: null,
  message: "Could not find the 'collateral_description' column of 'loans' in the schema cache"
}
 POST /api/loans 500 in 308ms
 ‚úì Compiled in 26ms
 ‚úì Compiled in 30ms
 ‚úì Compiled in 28ms
 POST /api/loans 201 in 272ms
 DELETE /api/borrowers/9f376846-356f-44a7-9951-b9e3ba35bdda 200 in 188ms
 POST /api/borrowers 201 in 192ms
 POST /api/loans 201 in 152ms
 ‚úì Compiled /admin/loans in 369ms
 GET /admin/loans 200 in 388ms
 GET /admin/loans 200 in 78ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 223ms
 ‚úì Compiled middleware in 1ms
 GET /admin/loans 200 in 73ms
 GET /admin/loans 200 in 20ms
 ‚úì Compiled in 32ms
 ‚úì Compiled in 26ms
 ‚úì Compiled middleware in 0ms
 GET /admin/loans 200 in 72ms
 GET /admin/loans 200 in 18ms
 ‚úì Compiled /api/notifications in 151ms
Error fetching notifications: {
  code: '42P01',
  details: null,
  hint: null,
  message: 'relation "public.notifications" does not exist'
}
 GET /api/notifications 500 in 265ms
Error fetching notifications: {
  code: '42P01',
  details: null,
  hint: null,
  message: 'relation "public.notifications" does not exist'
}
 GET /api/notifications 200 in 167ms
 ‚úì Compiled in 28ms
 GET /api/notifications 200 in 51ms
 POST /api/notifications 201 in 14ms
 GET /api/notifications 200 in 12ms
 GET /admin/loans 200 in 146ms
 GET /api/notifications 200 in 18ms
 GET /api/notifications 200 in 14ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 233ms
 GET /api/notifications 200 in 15ms
 ‚ö† Fast Refresh had to perform a full reload due to a runtime error.
 ‚úì Compiled in 29ms
 GET /admin/loans 200 in 105ms
 GET /api/notifications 200 in 15ms
 GET /api/notifications 200 in 15ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 221ms
 GET /api/notifications 200 in 16ms
 PATCH /api/notifications?action=mark_all_read 200 in 43ms
 ‚úì Compiled /admin/loans/[id] in 369ms
 GET /admin/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 562ms
 GET /api/notifications 200 in 34ms
 GET /api/notifications 200 in 16ms
 ‚úì Compiled /api/loans/[id] in 181ms
 GET /api/notifications 200 in 12ms
 GET /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 421ms
 ‚úì Compiled /api/docusign/envelope in 192ms
üìã Creating DocuSign envelope for loan: 415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd
üìã Loan data prepared for DocuSign: {
  loanNumber: 'PSL1751169448656',
  borrowerEmail: 'ssalas.wt@gmail.com',
  borrowerName: 'Sebastian SALAS'
}
üîê Starting DocuSign JWT authentication...
üìã Environment variables check:
- Integration Key: f92510aa...
- User ID: 590d7838...
- Private Key: Present
üîë Private key processed, length: 1675
üöÄ Requesting JWT token...
‚úÖ JWT token received successfully
üì§ Sending envelope to DocuSign...
‚úÖ DocuSign envelope created: 99c82cb8-ed56-4e3c-a730-59b33ff9dd61
 POST /api/docusign/envelope 200 in 4368ms
 GET /admin/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 74ms
 GET /api/notifications 200 in 16ms
 GET /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 84ms
 GET /api/notifications 200 in 18ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 224ms
 GET /api/notifications 200 in 12ms
 ‚úì Compiled /api/docusign/status/[envelopeId] in 184ms
üîç Checking DocuSign envelope status: 99c82cb8-ed56-4e3c-a730-59b33ff9dd61
üîê Starting DocuSign JWT authentication...
üìã Environment variables check:
- Integration Key: f92510aa...
- User ID: 590d7838...
- Private Key: Present
üîë Private key processed, length: 1675
üöÄ Requesting JWT token...
‚úÖ JWT token received successfully
üìã DocuSign envelope data: {
  envelopeId: '99c82cb8-ed56-4e3c-a730-59b33ff9dd61',
  status: 'sent',
  completedDateTime: undefined,
  statusChangedDateTime: '2025-06-29T04:02:24.6630000Z',
  hasSignedRecipients: false,
  recipients: [
    {
      name: 'Sebastian SALAS',
      email: 'ssalas.wt@gmail.com',
      status: 'delivered',
      signedDateTime: undefined
    }
  ]
}
üîç Current loan status in DB: {
  loanId: '415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd',
  currentDocuSignStatus: 'sent',
  currentLoanStatus: 'new',
  newDocuSignStatus: 'sent'
}
üìã No status change detected, skipping database update
 GET /api/docusign/status/99c82cb8-ed56-4e3c-a730-59b33ff9dd61 200 in 1228ms
 ‚úì Compiled /api/docusign/webhook in 211ms
üîî DocuSign webhook received: {
  "event": "envelope-sent",
  "apiVersion": "v2.1",
  "uri": "/restapi/v2.1/accounts/f1f26efe-2890-42a4-9e8c-ae553b858036/envelopes/99c82cb8-ed56-4e3c-a730-59b33ff9dd61",
  "retryCount": 0,
  "configurationId": 21788414,
  "generatedDateTime": "2025-06-29T04:02:07.7947418Z",
  "data": {
    "accountId": "f1f26efe-2890-42a4-9e8c-ae553b858036",
    "userId": "590d7838-c6fc-4584-81a5-a368233d46bb",
    "envelopeId": "99c82cb8-ed56-4e3c-a730-59b33ff9dd61"
  }
}
üìä Webhook headers: {
  'accept-encoding': 'gzip',
  'content-length': '413',
  'content-type': 'application/json; charset=utf-8',
  expect: '100-continue',
  host: '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'user-agent': 'docusign',
  'x-forwarded-for': '64.207.219.8',
  'x-forwarded-host': '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'https'
}
‚è∞ Webhook timestamp: 2025-06-29T04:02:30.756Z
‚ùå Missing required webhook data: {
  envelopeId: '99c82cb8-ed56-4e3c-a730-59b33ff9dd61',
  status: undefined
}
 POST /api/docusign/webhook 400 in 228ms
 GET /api/notifications 200 in 41ms
üîç Checking DocuSign envelope status: 99c82cb8-ed56-4e3c-a730-59b33ff9dd61
üîê Starting DocuSign JWT authentication...
üìã Environment variables check:
- Integration Key: f92510aa...
- User ID: 590d7838...
- Private Key: Present
üîë Private key processed, length: 1675
üöÄ Requesting JWT token...
‚úÖ JWT token received successfully
üìã DocuSign envelope data: {
  envelopeId: '99c82cb8-ed56-4e3c-a730-59b33ff9dd61',
  status: 'completed',
  completedDateTime: '2025-06-29T04:02:28.0230000Z',
  statusChangedDateTime: '2025-06-29T04:02:28.0230000Z',
  hasSignedRecipients: true,
  recipients: [
    {
      name: 'Sebastian SALAS',
      email: 'ssalas.wt@gmail.com',
      status: 'completed',
      signedDateTime: '2025-06-29T04:02:28.0230000Z'
    }
  ]
}
üîç Current loan status in DB: {
  loanId: '415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd',
  currentDocuSignStatus: 'sent',
  currentLoanStatus: 'new',
  newDocuSignStatus: 'completed'
}
üéâ Document is actually signed!
üíæ Updating loan with new status: {
  docusign_status: 'signed',
  docusign_status_updated: '2025-06-29T04:02:39.611Z',
  status: 'signed',
  docusign_completed_at: '2025-06-29T04:02:28.0230000Z'
}
‚úÖ Loan 415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd updated: DocuSign signed, Loan status: signed
 GET /api/docusign/status/99c82cb8-ed56-4e3c-a730-59b33ff9dd61 200 in 1132ms
 GET /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 94ms
üîî DocuSign webhook received: {
  "event": "envelope-delivered",
  "apiVersion": "v2.1",
  "uri": "/restapi/v2.1/accounts/f1f26efe-2890-42a4-9e8c-ae553b858036/envelopes/99c82cb8-ed56-4e3c-a730-59b33ff9dd61",
  "retryCount": 0,
  "configurationId": 21788414,
  "generatedDateTime": "2025-06-29T04:02:25.1491301Z",
  "data": {
    "accountId": "f1f26efe-2890-42a4-9e8c-ae553b858036",
    "userId": "590d7838-c6fc-4584-81a5-a368233d46bb",
    "envelopeId": "99c82cb8-ed56-4e3c-a730-59b33ff9dd61"
  }
}
üìä Webhook headers: {
  'accept-encoding': 'gzip',
  'content-length': '418',
  'content-type': 'application/json; charset=utf-8',
  expect: '100-continue',
  host: '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'user-agent': 'docusign',
  'x-forwarded-for': '64.207.219.8',
  'x-forwarded-host': '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'https'
}
‚è∞ Webhook timestamp: 2025-06-29T04:02:46.552Z
‚ùå Missing required webhook data: {
  envelopeId: '99c82cb8-ed56-4e3c-a730-59b33ff9dd61',
  status: undefined
}
 POST /api/docusign/webhook 400 in 45ms
 GET /admin/loans 200 in 42ms
 GET /api/notifications 200 in 38ms
 GET /api/notifications 200 in 37ms
 GET /api/notifications 200 in 28ms
üîî DocuSign webhook received: {
  "event": "envelope-completed",
  "apiVersion": "v2.1",
  "uri": "/restapi/v2.1/accounts/f1f26efe-2890-42a4-9e8c-ae553b858036/envelopes/99c82cb8-ed56-4e3c-a730-59b33ff9dd61",
  "retryCount": 0,
  "configurationId": 21788414,
  "generatedDateTime": "2025-06-29T04:02:28.7736491Z",
  "data": {
    "accountId": "f1f26efe-2890-42a4-9e8c-ae553b858036",
    "userId": "590d7838-c6fc-4584-81a5-a368233d46bb",
    "envelopeId": "99c82cb8-ed56-4e3c-a730-59b33ff9dd61"
  }
}
üìä Webhook headers: {
  'accept-encoding': 'gzip',
  'content-length': '418',
  'content-type': 'application/json; charset=utf-8',
  expect: '100-continue',
  host: '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'user-agent': 'docusign',
  'x-forwarded-for': '64.207.219.8',
  'x-forwarded-host': '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'https'
}
‚è∞ Webhook timestamp: 2025-06-29T04:02:49.812Z
‚ùå Missing required webhook data: {
  envelopeId: '99c82cb8-ed56-4e3c-a730-59b33ff9dd61',
  status: undefined
}
 POST /api/docusign/webhook 400 in 41ms
 GET /admin/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 76ms
 GET /api/notifications 200 in 14ms
 GET /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 88ms
 GET /api/notifications 200 in 15ms
 GET /api/notifications 200 in 14ms
 ‚úì Compiled /api/loans/[id]/approve in 199ms
üîç Approving loan: 415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd
‚úÖ Loan approved successfully: PSL1751169448656
 POST /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd/approve 200 in 423ms
 GET /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 77ms
 GET /api/notifications 200 in 15ms
 ‚úì Compiled /api/loans/[id]/send-payment-summary in 199ms
Error: Route "/api/loans/[id]/send-payment-summary" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (src/app/api/loans/[id]/send-payment-summary/route.ts:10:26)
   8 |   try {
   9 |     const supabase = await createClient();
> 10 |     const loanId = params.id;
     |                          ^
  11 |
  12 |     if (!loanId) {
  13 |       return NextResponse.json(
Error fetching loan: {
  code: '42703',
  details: null,
  hint: null,
  message: 'column loans.borrower_name does not exist'
}
 POST /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd/send-payment-summary 404 in 448ms
 GET /api/notifications 200 in 43ms
 GET /api/notifications 200 in 38ms
 GET /api/notifications 200 in 33ms
 GET /api/notifications 200 in 34ms
 GET /api/notifications 200 in 32ms
 GET /api/notifications 200 in 25ms
 GET /api/notifications 200 in 21ms
 GET /api/notifications 200 in 12ms
 GET /api/notifications 200 in 32ms
 GET /api/notifications 200 in 35ms
 GET /api/notifications 200 in 36ms
 GET /api/notifications 200 in 33ms
 GET /api/notifications 200 in 35ms
 GET /admin/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 71ms
 GET /api/notifications 200 in 21ms
 GET /api/loans/415a719d-4bbf-4f7d-bf9f-0466a6ed6cdd 200 in 78ms
 GET /api/notifications 200 in 15ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 228ms
 GET /api/notifications 200 in 15ms
 GET /admin/loans/create 200 in 103ms
 GET /api/notifications 200 in 19ms
 GET /api/notifications 200 in 22ms
 GET /api/notifications 200 in 39ms
 GET /admin/loans 200 in 50ms
 GET /api/notifications 200 in 27ms
 GET /api/notifications 200 in 32ms
 GET /api/notifications 200 in 23ms
 GET /admin/borrowers 200 in 90ms
 GET /api/notifications 200 in 19ms
 GET /api/notifications 200 in 27ms
 GET /api/notifications 200 in 34ms
 DELETE /api/borrowers/0bdfb0de-ac47-4a24-b764-c1fe59d6725d 200 in 194ms
 GET /admin/loans/create 200 in 49ms
 GET /api/notifications 200 in 39ms
 GET /api/notifications 200 in 34ms
 GET /api/notifications 200 in 29ms
 POST /api/borrowers 201 in 169ms
 POST /api/notifications 201 in 21ms
 POST /api/loans 201 in 227ms
 GET /api/notifications 200 in 38ms
 GET /admin/loans 200 in 36ms
 GET /api/notifications 200 in 15ms
 GET /api/notifications 200 in 17ms
 GET /api/notifications 200 in 16ms
 GET /admin/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 77ms
 GET /api/notifications 200 in 19ms
 GET /api/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 88ms
 GET /api/notifications 200 in 13ms
 GET /api/notifications 200 in 13ms
 GET /admin/loans 200 in 48ms
 GET /api/notifications 200 in 16ms
 GET /api/notifications 200 in 24ms
 GET /api/notifications 200 in 21ms
 GET /admin/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 73ms
 GET /api/notifications 200 in 13ms
 GET /api/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 86ms
 GET /api/notifications 200 in 14ms
 GET /api/notifications 200 in 14ms
üìã Creating DocuSign envelope for loan: 7db9f79e-7b04-4036-9895-b769eb148c3e
üìã Loan data prepared for DocuSign: {
  loanNumber: 'PSL1751170231463',
  borrowerEmail: 'ssalas.wt@gmail.com',
  borrowerName: 'Sebastian SALAS'
}
üîê Starting DocuSign JWT authentication...
üìã Environment variables check:
- Integration Key: f92510aa...
- User ID: 590d7838...
- Private Key: Present
üîë Private key processed, length: 1675
üöÄ Requesting JWT token...
‚úÖ JWT token received successfully
üì§ Sending envelope to DocuSign...
‚úÖ DocuSign envelope created: 9ea68554-fefb-4847-880a-4f0957e3f3dd
 POST /api/docusign/envelope 200 in 3663ms
 GET /admin/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 76ms
 GET /api/notifications 200 in 18ms
 GET /api/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 67ms
 GET /api/notifications 200 in 12ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 224ms
 GET /api/notifications 200 in 14ms
 PATCH /api/notifications?id=3&action=mark_read 200 in 41ms
üîç Checking DocuSign envelope status: 9ea68554-fefb-4847-880a-4f0957e3f3dd
üîê Starting DocuSign JWT authentication...
üìã Environment variables check:
- Integration Key: f92510aa...
- User ID: 590d7838...
- Private Key: Present
üîë Private key processed, length: 1675
üöÄ Requesting JWT token...
‚úÖ JWT token received successfully
üìã DocuSign envelope data: {
  envelopeId: '9ea68554-fefb-4847-880a-4f0957e3f3dd',
  status: 'sent',
  completedDateTime: undefined,
  statusChangedDateTime: '2025-06-29T04:11:20.2830000Z',
  hasSignedRecipients: false,
  recipients: [
    {
      name: 'Sebastian SALAS',
      email: 'ssalas.wt@gmail.com',
      status: 'sent',
      signedDateTime: undefined
    }
  ]
}
üîç Current loan status in DB: {
  loanId: '7db9f79e-7b04-4036-9895-b769eb148c3e',
  currentDocuSignStatus: 'sent',
  currentLoanStatus: 'new',
  newDocuSignStatus: 'sent'
}
üìã No status change detected, skipping database update
 GET /api/docusign/status/9ea68554-fefb-4847-880a-4f0957e3f3dd 200 in 846ms
üîî DocuSign webhook received: {
  "event": "envelope-sent",
  "apiVersion": "v2.1",
  "uri": "/restapi/v2.1/accounts/f1f26efe-2890-42a4-9e8c-ae553b858036/envelopes/9ea68554-fefb-4847-880a-4f0957e3f3dd",
  "retryCount": 0,
  "configurationId": 21788414,
  "generatedDateTime": "2025-06-29T04:11:20.4865249Z",
  "data": {
    "accountId": "f1f26efe-2890-42a4-9e8c-ae553b858036",
    "userId": "590d7838-c6fc-4584-81a5-a368233d46bb",
    "envelopeId": "9ea68554-fefb-4847-880a-4f0957e3f3dd"
  }
}
üìä Webhook headers: {
  'accept-encoding': 'gzip',
  'content-length': '413',
  'content-type': 'application/json; charset=utf-8',
  expect: '100-continue',
  host: '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'user-agent': 'docusign',
  'x-forwarded-for': '64.207.219.7',
  'x-forwarded-host': '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'https'
}
‚è∞ Webhook timestamp: 2025-06-29T04:11:41.937Z
‚ùå Missing required webhook data: {
  envelopeId: '9ea68554-fefb-4847-880a-4f0957e3f3dd',
  status: undefined
}
 POST /api/docusign/webhook 400 in 39ms
 GET /api/notifications 200 in 33ms
üîç Checking DocuSign envelope status: 9ea68554-fefb-4847-880a-4f0957e3f3dd
üîê Starting DocuSign JWT authentication...
üìã Environment variables check:
- Integration Key: f92510aa...
- User ID: 590d7838...
- Private Key: Present
üîë Private key processed, length: 1675
üöÄ Requesting JWT token...
‚úÖ JWT token received successfully
üìã DocuSign envelope data: {
  envelopeId: '9ea68554-fefb-4847-880a-4f0957e3f3dd',
  status: 'completed',
  completedDateTime: '2025-06-29T04:11:47.9300000Z',
  statusChangedDateTime: '2025-06-29T04:11:47.9300000Z',
  hasSignedRecipients: true,
  recipients: [
    {
      name: 'Sebastian SALAS',
      email: 'ssalas.wt@gmail.com',
      status: 'completed',
      signedDateTime: '2025-06-29T04:11:47.9300000Z'
    }
  ]
}
üîç Current loan status in DB: {
  loanId: '7db9f79e-7b04-4036-9895-b769eb148c3e',
  currentDocuSignStatus: 'sent',
  currentLoanStatus: 'new',
  newDocuSignStatus: 'completed'
}
üéâ Document is actually signed!
 POST /api/notifications 201 in 21ms
‚úÖ Notification created for signed document
üíæ Updating loan with new status: {
  docusign_status: 'signed',
  docusign_status_updated: '2025-06-29T04:11:52.862Z',
  status: 'signed',
  docusign_completed_at: '2025-06-29T04:11:47.9300000Z'
}
‚úÖ Loan 7db9f79e-7b04-4036-9895-b769eb148c3e updated: DocuSign signed, Loan status: signed
 GET /api/docusign/status/9ea68554-fefb-4847-880a-4f0957e3f3dd 200 in 953ms
 GET /api/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 76ms
 GET /api/notifications 200 in 37ms
üîî DocuSign webhook received: {
  "event": "envelope-delivered",
  "apiVersion": "v2.1",
  "uri": "/restapi/v2.1/accounts/f1f26efe-2890-42a4-9e8c-ae553b858036/envelopes/9ea68554-fefb-4847-880a-4f0957e3f3dd",
  "retryCount": 0,
  "configurationId": 21788414,
  "generatedDateTime": "2025-06-29T04:11:41.2280085Z",
  "data": {
    "accountId": "f1f26efe-2890-42a4-9e8c-ae553b858036",
    "userId": "590d7838-c6fc-4584-81a5-a368233d46bb",
    "envelopeId": "9ea68554-fefb-4847-880a-4f0957e3f3dd"
  }
}
üìä Webhook headers: {
  'accept-encoding': 'gzip',
  'content-length': '418',
  'content-type': 'application/json; charset=utf-8',
  expect: '100-continue',
  host: '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'user-agent': 'docusign',
  'x-forwarded-for': '64.207.219.8',
  'x-forwarded-host': '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'https'
}
‚è∞ Webhook timestamp: 2025-06-29T04:12:02.754Z
‚ùå Missing required webhook data: {
  envelopeId: '9ea68554-fefb-4847-880a-4f0957e3f3dd',
  status: undefined
}
 POST /api/docusign/webhook 400 in 44ms
üîî DocuSign webhook received: {
  "event": "envelope-completed",
  "apiVersion": "v2.1",
  "uri": "/restapi/v2.1/accounts/f1f26efe-2890-42a4-9e8c-ae553b858036/envelopes/9ea68554-fefb-4847-880a-4f0957e3f3dd",
  "retryCount": 0,
  "configurationId": 21788414,
  "generatedDateTime": "2025-06-29T04:11:48.6797971Z",
  "data": {
    "accountId": "f1f26efe-2890-42a4-9e8c-ae553b858036",
    "userId": "590d7838-c6fc-4584-81a5-a368233d46bb",
    "envelopeId": "9ea68554-fefb-4847-880a-4f0957e3f3dd"
  }
}
üìä Webhook headers: {
  'accept-encoding': 'gzip',
  'content-length': '418',
  'content-type': 'application/json; charset=utf-8',
  expect: '100-continue',
  host: '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'user-agent': 'docusign',
  'x-forwarded-for': '64.207.219.7',
  'x-forwarded-host': '77b4-2600-4040-2d1a-dc00-79f1-da95-820f-9186.ngrok-free.app',
  'x-forwarded-port': '3000',
  'x-forwarded-proto': 'https'
}
‚è∞ Webhook timestamp: 2025-06-29T04:12:10.224Z
‚ùå Missing required webhook data: {
  envelopeId: '9ea68554-fefb-4847-880a-4f0957e3f3dd',
  status: undefined
}
 POST /api/docusign/webhook 400 in 43ms
üîç Approving loan: 7db9f79e-7b04-4036-9895-b769eb148c3e
‚úÖ Loan approved successfully: PSL1751170231463
 POST /api/loans/7db9f79e-7b04-4036-9895-b769eb148c3e/approve 200 in 83ms
 GET /api/loans/7db9f79e-7b04-4036-9895-b769eb148c3e 200 in 116ms
 GET /api/notifications 200 in 40ms
 GET /api/notifications 200 in 34ms
 GET /api/notifications 200 in 33ms
 GET /api/notifications 200 in 34ms
 GET /api/notifications 200 in 33ms
 GET /api/notifications 200 in 40ms
 GET /api/notifications 200 in 40ms
 GET /api/notifications 200 in 41ms
 GET /api/notifications 200 in 34ms
 GET /api/notifications 200 in 27ms
 GET /api/notifications 200 in 31ms
